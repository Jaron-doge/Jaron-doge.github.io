---
title: 第3章 进程
date: 2020-10-4 20:30:15
tags: 
categories: 操作系统
---
## 第3章 进程

### 多道程序技术

#### 程序顺序执行时的特征

<!-- more -->

- 顺序性 
- 封闭性
- 可再现性

### 进程概念

- 进程 = 程序段 + 数据段 + 进程控制块(PCB)

#### 进程状态

- new
- running
- waiting/blocked
- ready
- terminated

#### 进程挂起

![image-20201003195825977.png](https://i.loli.net/2020/10/03/gEfw2RQKFs3qyx6.png)

#### 进程控制块(PCB)

- 是操作系统中的一种关键数据结构
- 由操作系统进程管理模块维护
- 常驻内存

![image-20201003200305684.png](https://i.loli.net/2020/10/03/v1OCF5mylPsGShQ.png)

![image-20201003200325408.png](https://i.loli.net/2020/10/03/3dhoUWXRJGe1fBm.png)

### 进程调度

- ready queue——内存中准备和等待执行
- device queue——等待I / O设备的进程集

![image-20201003200657117](D:\study\大二\操作系统原理\Notes\images\image-20201003200657117.png)

#### 调度器

- Long-term scheduler选择应将哪些进程带入ready queue
- Short-term scheduler选择CPU执行哪个进程
  - 从ready queue
  - 频度高
- Medium-term scheduler
  - 可以降低多道程序运行的度（与Long-term scheduler相反）

#### 上下文切换

- 当进行上下文切换时，内核会将旧进程状态保存在其PCB中，然后加载经调度而要执行的新进程的上下文

### 进程操作

#### 进程创建

- 通常，进程是通过进程标识符(pid)标志和管理的

##### 资源共享

当一个进程创建子进程时，有三种共享方式:

- 父子共享全部资源
- 孩子享有部分资源
- 父子不共享资源

##### 运行

- 父子并发执行
- 父进程必须等子进程结束

- 子进程复制父进程的空间

### 进程间通信（IPC）

优点：

- 信息共享：共享文件  VS 几个用户
- 计算速度提高：1任务  VS 与多个处理元素（例如CPU或I / O通道）并行的几个子任务
- 模块化
- 便利：1个用户  VS 几个任务

#### IPC的两个基础模式

##### 消息传递模式

- 可用于交换少量数据，因为无需避免冲突
- 更容易实施
- 通过系统调用（例如send（），receive（））交换信息

##### 共享内存模式

- 通过内存访问有更快的内存速度
- 系统调用仅用于建立共享内存区域

![image-20201003202940281.png](https://i.loli.net/2020/10/03/6P7caQsfzDOUySh.png)

### 作业

3.1 Using the program shown in Figure 3.30, explain what the output will
be at LINE A.

![image-20201004120745412.png](https://i.loli.net/2020/10/04/zX2KsqfngIwNPaO.png)

PARENT: value = 5

因为fork()会创建一个子进程，子进程会复制父进程的代码、全局变量、堆栈等，所以在子进程中对变量的修改影响不到父进程。

3.2 Including the initial parent process, how many processes are created by the program shown in Figure 3.31?

![image-20201004114833943.png](https://i.loli.net/2020/10/04/POQlMDoAxaBeCiS.png)

一共8个，第一个fork()后复制父进程，共有2个进程；第二个fork()后复制前两个进程，共四个进程；依次类推，一共8个。

3.5 When a process creates a new process using the fork() operation, which of the following states is shared between the parent process and the child
process?
a. Stack
b. Heap
c. Shared memory segments

c

3.8 Describe the differences among short-term, medium-term, and long-term scheduling.

短期调度器：从准备队列中选择进程分配到CPU中执行，运行频率高

中期调度器：将部分进程从内存中移出，降低多道程序程度

长期调度器：选择将哪些进程带入准备队列，运行频率低



3.9 Describe the actions taken by a kernel to context-switch between
processes.

kernel保存正在运行的进程的状态到它的PCB中，并加载经调度而要执行的新进程的上下文。



3.11 Explain the role of the init process on UNIX and Linux systems in regard to process termination.

UNIX和Linux将init进程作为孤儿进程的父进程。进程init定期调用wait()，以便收集任何孤儿进程的退出状态，并释放孤儿进程标识符和进程表条目



3.12 Including the initial parent process, how many processes are created by the program shown in Figure 3.32?

![image-20201004114857480.png](https://i.loli.net/2020/10/04/DWY3XBUQ2jLNzoq.png)

一共16个，第一次fork()后复制父进程，共有2个进程；第二次fork()后复制前两个进程，共四个进程；依次类推，共fork()四次，一共16个。



3.13 Explain the circumstances under which which the line of code marked
printf("LINE J") in Figure 3.33 will be reached.

![image-20201004195716479.png](https://i.loli.net/2020/10/04/1Q2XhVRf86jxYOe.png)

当execlp()的调用发生错误时



3.14 Using the program in Figure 3.34, identify the values of pid at lines A, B, C, and D. (Assume that the actual pids of the parent and child are 2600
and 2603, respectively.)

![image-20201004114933324.png](https://i.loli.net/2020/10/04/h1afI3uKD5dpNA9.png)

A = 0, B = 2603, C = 2603, D = 2600