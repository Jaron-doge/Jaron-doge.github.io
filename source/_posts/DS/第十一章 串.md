---
title: 第十一章 串
date: 2020-10-08 20:30:15
tags: 
categories: 数据结构
---
## 第十一章 串

### 蛮力匹配

#### 版本一

<!-- more -->

```c++
int match(char* P, char* T) {
    size_t n = strlen(T), i = 0;
    size_t m = strlen(P), j = 0;
    while(j < m && i < n) 
        if(P[j] == T[i]) {
            i++; j++;
        }
    	else {
            i -= j - 1;
            j = 0;
        }
    return i - j;			// i - j > n - m 越界
}
```

#### 版本二

![image-20200928161008978.png](https://i.loli.net/2020/09/28/OARj3sqQmFgy5Sd.png)

```c++
int match(char* P, char* T) {
    size_t n = strlen(T), i = 0;
    size_t m = strlen(P), j;
    for(i = 0; i < n - m + 1; i++) {
        for(j = 0; j < m; j++) 
            if(T[i + j] != P[j])
                break;
        if(m <= j)
            break;
    }
    return i;
}
```

### KMP算法

​	N(P, j) = {0 ≤ t < j | P[0, t) == P[j - t, j) }

![image-20200928170853743.png](https://i.loli.net/2020/09/28/qrp5MAe28VjEmNv.png)

```c++
int match(char* P, char* T) {
    int* next = bulidNext(P);		// 构造next表
    int n = (int) strlen(T), i = 0;
    int m = (int )strlen(P), j = 0;
    while(j < m && i < n) 
        if(0 > j || T[i] == P[j]) {	// 若匹配
            i++; j++;
        } else 						// 否则，P右移，T不回退
            j = next[j];
    delete [] next;					// 释放next表
    return i - j;	
}
```

#### next表

next(j)是在P[0, j)中最大自匹配的真前缀和真后缀的长度

```c++
int* buildNext(char* P) {
    size_t m = strlen(P), j = 0;
    int* N = new int[m];			// next表
    int k = N[0] = -1;
    while(j < m - 1)
        if(0 > k || P[j] == P[k]) 	// 匹配
            N[++j] = ++k;
    	else						// 失效
            k = N[k];
    return N;
}
```

### BM_BC算法(坏字符策略)

- 从后向前匹配

#### BC表

```c++
int* buildBC(char* P) {
    int* bc = new int[256];
    for(int j = 0; j < 256; j++) bc[j] = -1;
    for(int m = strlen(P), j = 0; j < m; j++)
        bc[P[j]] = j;
    return bc;
}
```

### BM_GS算法(好后缀策略)

#### 构建gs表

##### MS[] -> ss[]

![image-20201007201021840.png](https://i.loli.net/2020/10/08/ltOuBH1ypiINcha.png)

##### ss[] -> gs[]

![image-20201007201113350.png](https://i.loli.net/2020/10/08/XJuYFGhi9krAoVy.png)

### Karp-Rabin算法

![image-20201007202217494.png](https://i.loli.net/2020/10/08/BJ8LexK1tCDMOHq.png)

