---
title: 第10章 网络信息获取及Xml处理
date: 2021-4-10 24:00:00
tags: 
categories: C#&nbsp;
---
## 网络信息获取及Xml处理

### 10.1 网络信息获取的基本方式

#### 10.1.1 网络信息浏览

<!-- more -->

- HTTP协议

- 客户端与服务端
- Request与Response
- Stream

- Get与Post

#### 10.1.2 一些查看工具

- Fiddler2
- Chrome/FireFox等浏览器F12
  - Chrome中按F12， 或点右键，“审查元素”

#### 10.1.3 使用System.Web

System.Web提供支持浏览器/服务器通讯的类和接口

**System.Net中的类**

![4.png](https://i.loli.net/2021/04/20/26HmlvrEXeVpRGf.png)

#### 10.1.4 WebClient类

**DownloadData及DownloadFile**

- 后来又有DownloadString
- UploadData及UploadFile
- OpenRead及OpenWrite

**示例**

```c#
string url= @"http://www.baidu.com";
WebClientclient = new WebClient();
byte[] pageData= client.DownloadData(url);
string pageHtml= Encoding.Default.GetString(pageData);
Console.WriteLine(pageHtml);
```

#### 10.1.5 WebRequest及WebResponse

```c#
WebRequest myRequest = WebRequest.Create("http://www.contoso.com");
WebResponse myResponse = myRequest.GetResponse();
Stream requestStream = myRequest.GetRequestStream()
Stream receiveStream =myWebResponse.GetResponseStream();
```

#### 10.1.6 一些术语

- Credentials: 主要指用户名、密码等
- Header：头部信息
- Cookie： Cookie信息
- User-Agent: 用户代理（浏览器）
- Refer：由哪个页面进行的访问

### 10.2 XML基本操作

#### 10.2.1 XML的内容

- 声明\<?xml version = '1.0' ...?>

- 实体\<!Entity...>
- 元素\<book> ... \</book>

- 属性\<book title = "..." />

- 注释\<!-- some comments -->

- 特殊字符

  < > 分别表示为\&lt; \&gt;

#### 10.2.2 XML的处理方式

**DOM**

文档对象模式(Document Object Model)

- 把整个文档装入内存，建立一个树状结构处理

**SAX**

XML解析的简单API(Simple API for XML)

- 读到一个标记处理一下

#### 10.2.3 常用的XML类

**XmlDocument**

- .LoadXml()	.DocumentElement

**XmlNode的属性**

- .ChildNodes	.HasChildNodes,	.FirstChildNode
- .InnerXml    .InnerText    .OutterXml    .Value
- .NodeType
- 子类XmlDocument, XmlElement
  - XmlAttribute, XmlEntity

### 10.3 XPath及Xslt编辑

#### 10.3.1 XPath的概念

XPath是对XML进行查询的表达式

- Axes(路径)	/  及  //
  - /books/book/@title         一层
  - //price                                一直向下找到为止 

- 第几个子节点 [1] 等

- 属性  @
- 条件  []
  - para\[@type = "warning"][5]

#### 10.3.2 XSLT

XSLT 指 XSL 转换。使用 XSLT 将 XML 文档转换为其他文档，比如 XHTML。

```c#
try
{
    XmlDocument doc = new XmlDocument();
    doc.Load(@".\BookList.xml");

    XPathNavigator nav =doc.CreateNavigator();
    nav.MoveToRoot();

    XslTransform xt = new XslTransform();
    xt.Load(@".\BookList.xslt");

    XmlTextWriter writer = new XmlTextWriter(Console.Out);

    xt.Transform(nav,  null, writer);
}
catch( XmlException e )
{
    Console.WriteLine("XML Exception:" + e.ToString());
}
catch( XsltException e )
{
    Console.WriteLine("XSLT Exception:" + e.ToString());
}
```

### 10.4 示例

