---
title: 第3章 类
date: 2021-4-3 24:00:00
tags: 
categories: C#&nbsp;
---
## 类

### 3.1 this

<!-- more -->

- 访问这个对象的字段及方法
- 区分字段与局部变量
- 用于构造方法调用另一个构造方法

```c#
public Person() : this(0, "") {}
```

### 3.2 属性、索引

#### 属性的书写

```C#
public string Name{get; set;}
```

- 可以只读或只写：只有get或set
- 可以进行有效性检查：if
- 可以是计算得到的数据
- 可以定义抽象属性

#### 索引器

```c#
修饰符	类型名	this[parameter]
{
    set
    {
        
    }
    get
    {
        
    }
}
```

### 3.3 类的继承

- C#采用单继承（只能继承一个父类）

- 所有类都是通过继承object得到

#### 字段的继承、添加与隐藏

- 继承：自动
- 添加：定义新变量
  - 重载(Overloading)
  - 覆盖(Overriding)
- 隐藏：同名关键字前面加一个new

#### 使用base

调用父类的方法

```C#
Student(string name, int age, string school)
    : base(name, age)
    { this.school = school; }
```

#### 转换

```C#
Person p1 = new Person();
Person p2 = new Student();
Student s1 = new Student();
Student s2 = new Student();
p1 = s1;	// 可以
s2 = p1;	// 不行
s2 = (Student)p1;	// 可以
s2 = (Student)p2;	//可以，因为p2引用的正好是Student实例
```

**as运算符**

如果不能转换，则值为null，**不会引起异常**

```c#
Student s3 = p1 as Student;		// 结果为null
```

**is运算符**

判断一个对象是不是某个类(**及其子类**)的实例

```c#
if(p is Person)
```

### 3.4 修饰符

#### 3.4.1 访问控制符

<img src="https://i.loli.net/2021/04/20/3hJB7SmdY8s6eMR.png" alt="3.png" style="zoom:80%;" />

- 类中的字段、方法默认为private，包括构造函数

#### 3.4.2 static

- 调用static方法时，直接用类名访问

#### 3.4.3 const及readonly

- 常量兼有只读和静态，所以常量一定是静态的，但只读字段不一定是。
- 只读字段可以在运行时决定（例如在构造函数中赋值），而常量必须在定义时就赋值。

- 只读字段可修饰任何类型。
- 即使对于引用类型的只读字段，我们也可以更改引用类型引用对象的值，但是， 我们不能更改引用类型的引用本身。

```c#
A a = new A();
a.print();                      //0
//可以更改引用对象成员的值
a.field.b = 999;
a.print();                      //999
//但是不可以更改引用本身
//a.field = new B();
//a.str = "hello";
```

#### 3.4.4 sealed及abstract

- sealed类——不可继承

- abstract类——不可实例化(new)

- abstract的方法体，不用{}，用;
  - abstract	类型	方法名(参数列表);

#### 小结

<img src="3 类/2.png" alt="2" style="zoom:80%;" />

### 3.5 接口

- 接口是一个引用类型，比抽象类更抽象
- 接口能实现多继承

定义一个接口

```c#
public interface IStringList
{
    void Add(string s);
    int Count{get;}
	string this[int index] {get; set;}
}
```

public、abstract这两个关键词不写出来

 #### 3.5.1 同名

- 方法名前写接口名
- 调用前先强制转换((IWindow))f.Close()

### 3.6 结构及枚举

#### 3.6.1 struct

struct是值类型

- 结构不能包含无参数的构造方法
- 每个字在定义时，不能给初始值
- 构造方法中，必须对每个字段进行赋值

- struct是sealed的，不能被继承

- 值类型变量在赋值时，实行的**是字段的copy**

**结构 VS 类**

​		类的对象是存储在堆空间中，结构存储在栈中。堆空间大，但访问速度较慢，栈空间小，访问速度相对更快。

​		类是引用类型，结构是值类型。**结构体中声明的字段无法赋予初值，类可以**。

#### 3.6.2 enum

枚举值要用来表示符号化的常量

```c#
c = (MyColor)Enum.Parse(typeof(MyColor), "Red");
```

