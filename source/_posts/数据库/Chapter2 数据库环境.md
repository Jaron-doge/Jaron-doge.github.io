---
title: 第二章 数据库环境
date: 2021-4-1 24:00:00
tags: 
categories: 数据库
---
## 第二章 数据库环境

### 2.1 ANSI-SPARC三层体系结构

<!-- more -->

![3.png](https://i.loli.net/2021/05/05/tiply8ef9kZP4SJ.png)

用户从外部层观察数据，DBMS和OS从内部层观察数据。概念层提供内、外部层的映射和必要的独立性。

- 每个用户都能访问相同数据，但可用各自定制的数据视图。
- 用户与数据库的交互应该独立与存储细节
- DBA能在不影响用户视图的情况下修改数据库存储结构
- 数据库的内部结构不受存储的物理变化影响，例如转移数据
- DBA能在不影响所有用户的情况下修改数据库的概念结构

#### 2.1.1 外部层

**|外部层|**：数据库的用户视图。这一层描述与每一个用户相关的数据库部分。

- 外部层由数据库的若干不同视图组成。
- 描述数据库中与特定用户相关的部分。

#### 2.1.2 概念层

**|概念层|**：数据库的整体视图。这一层描述了哪些数据被存储在数据库中，以及这些数据之间的联系。

这一层包含DBA看到的整个数据库的逻辑结构。概念层描述:

- 所有实体、实体的属性和实体间的联系;
- 数据的约束;
- 数据的语义信息;
- 安全性和完整性信息。

例：对于实体的描述只包含属性的数据类型，以及它们的长度，但是不包括实际所占用的字节数。

#### 2.1.3 内部层

**|内部层|**：数据库在计算机上的物理表示。这一层描述数据是如何存储在数据库中的。

- 内部层包括为了得到数据库运行时的最佳性能而采用的物理实现方法。它通过与OS的访问方法交互，完成在存储设备上存放数据等操作：
  - 数据和索引的存储空间分配;
  - 记录存储的描述(带有数据项的存储大小);
  - 记录位置;
  - 数据压缩与加密技术。
- 在内部层之下有一个物理层，可以在DBMS的指导下由操作系统控制。

#### 2.1.4 模式、映射和实例

对数据库的整体描述成为数据库模式，在任一时间点上，数据库中的数据构成一个数据库实例。

外部模式：与不同的数据视图相对应。

概念模式：描述所有的实体、属性和联系及其上的完整性约束。

内部模式：内部模型的完整描述。

#### 2.1.5 数据独立性

**|逻辑数据独立性|**：逻辑数据独立性指的是外部模式不受概念模式变化的影响。

**|物理数据独立性|**：物理数据独立性指的是概念模式不受内部模式变化的影响

### 2.2 数据库语言

数据库语言包括两个部分：Data Definition Language(DDL)和Data Manipulation Language(DML)，DDL用来说明数据库模式，DML用来读取和更新数据库。

#### 2.2.1 DDL

**|DDL|**：一种供DBA或用户描述和命名应用所需实体、属性和联系及其相关的完整性约束和安全约束的语言。

- DDL可用于定义模式或修改已存在的模式，但不能用来操作数据。

#### 2.2.2 DML

**|DML|**：提供了一组基本操作，支持对数据库中存储数据进行各种处理操作的语言。

- 增、删、改、查

##### 过程化DML

**|过程化DML|**：要求用户既告诉系统需要什么数据又说明如何检索这些数据的语言。

##### 非过程化DML

**|非过程化DML|**：只要求用户告诉系统需要哪些数据而不需说明如何检索它们的语言。也成为说明性语言。

### 2.3 数据模型和概念建模

**|数据模型|**：一组集成的概念，用于描述和操纵组织机构内的数据、数据间联系以及对数据的约束。

数据模型含下列三个组件：

- 结构部分，由一组创建数据库的规则构成。
- 操纵部分，定义允许对数据进行的操作的种类。
- 一组完整性约束，确保数据的准确性。

#### 2.3.1 基于对象的数据模型

基于对象的数据模型用到实体、属性和联系等概念。

- ER模型
- 语义模型

#### 2.3.2 基于记录的数据模型

在基于记录的数据模型中，数据库由若干不同类型的固定格式记录组成。

关系系统对数据库处理采用说明性的方法，而网状和层次系统采用导航的方法。

##### 关系数据模型

在关系模型中，数据和联系均以表格的形式表示，每个表格有若干具有唯一名称的列。

##### 网状数据模型

在网络数据模型中，数据被表示成一组记录，联系被表示成络(set)，具体实现时一般使用指针。

- 记录是节点而洛是边

##### 层次数据模型

层次数据模型是一种受限的网状模型，层次数据模型规定一个节点只能有一个父节点。

#### 2.3.3 物理数据模型

物理数据模型描述数据是如何存储在计算机中的，涉及记录结构、记录顺序及访问路径等信息。

### 2.4 DBMS的功能

**数据存储、检索和更新**

DBMS必须为用户提供在数据库中存储、检索和更新数据的能力。

**用户可访问的目录**

DBMS必须提供一个目录，内存各类数据项的描述并允许用户访问。

**事务支持**

DBMS必须提供一个机制，确保给定事务的所有更新操作或者完全做完或者一个都不做。

**并发控制服务**

DBMS必须提供一个机制，确保当多个用户并行地更新数据库时，数据库被正确更新。

**恢复服务**

DBMS必须提供一个机制，无论数据库因何种原因受到破坏时，都能恢复数据库。

**授权服务**

DBMS必须提供一个机制，确保只有经过授权的用户才可以访问数据库。

**支持数据通信**

DBMS必须能够与通信软件集成。

**完整性服务**

DBMS必须提供一种方法， 确保数据库中的数据和对数据的修改遵循一定的规则。

**提高数据独立性的服务**

DBMS必须提供机制，使程序独立于数据库的实际结构。

**实用服务程序**

DBMS应该提供一组实用服务程序

### 2.5 DBMS的组件

<img src="https://i.loli.net/2021/05/05/vNy5OaECrMeZHhD.png" alt="4.png" style="zoom:80%;" />

- 查询处理器：将所有的查询转换成一系列指导数据库管理器运行的低层指令
- DML预处理器：将嵌入应用程序中的DML语句转换成宿主语言中标准的函数调用
- DDL编译器：将DDL语句转换成一组包含元数据的表格
- 目录管理器：控制对系统目录的访问
- DM: DM与用户提交的应用程序和查询处理器接口

<img src="https://i.loli.net/2021/05/05/GHo8bUM2xgZEqsT.png" alt="5.png" style="zoom:80%;"  />

- 授权控制：这个模块检查用户是否具有必要的操作权限。
- 命令处理器：若有权限，则控制权交给命令管理器。
- 完整性检查其：兑与每个修改数据库的操作，检查请求的操作是否满足所有必要的完整性约束。
- 查询优化器：确定执行查询的最优策略。
- 事务管理器：执行从事务接收到的操作序列。
- 调度程序：确保当前数据库中并发运行的操作不相互冲突。

### 2.6 多用户DBMS结构

#### 2.6.1 远程处理

一台计算机和若干终端

#### 2.6.2 文件服务器结构

**|文件服务器|**：在网络上的一台计算机，其主要用途是为文档、电子表格、图像和数据库之类的计算机文件提供共享存储。

<img src="https://i.loli.net/2021/05/05/xrIlnRZdUN5QfaK.png" alt="6.png" style="zoom:80%;" />

- 数据库在文件服务器上
- 应用程序和DBMS运行在各个工作站点上

**缺点**：

- 网络拥塞

- 每台工作站上都要求有一个DBMS的完整副本

- 并发、恢复和完整性控制变得相当复杂，因为可能有多个DBMS访问同一个文件

#### 2.6.3 传统的两层客户-服务器结构

<img src="https://i.loli.net/2021/05/05/391HQhwDjlytOvx.png" alt="7.png" style="zoom:80%;" />

- 客户端管理用户界面和处理应用逻辑
- 数据库和DBMS在服务器上

**优点**：

- 广泛支持对现存数据库的访问
- 增强性能
- 降低硬件费用
- 降低通信费用
- 增强一致性

#### 2.6.4 事务处理监视器(TPM)

**|事务处理监视器|**：控制客户端和服务器之间数据传输的程序，旨在为应用提供一致的环境，尤其是为联机事务处理(OLTP)一类的应用。

复杂的应用程序经常建立在多个资源管理器之上。TP监视器是一个中间件，能访问各种资源管理器提供的服务，同时为事务型软件的开发者提供一个统一的接口。TP监视器作为三层结构中的中间层。

<img src="https://i.loli.net/2021/05/05/exN5bjSI8uVgqvK.png" alt="8.png" style="zoom:80%;" />

### 2.7 系统目录

**|系统目录|**：描述数据库中数据的信息存储库，即元数据

目录必须是用户可访问的

- 授权控制模块
- 完整性检查器模块
- 存放授权用户
- 每个数据项的约束

信息资源字典系统是一个ISO标准，定义了一组访问数据字典的方法。这样就允许共享字典，并且可以从一个系统转换到另一个系统。

### 作业

1. To address the issue of data independence, the ANSI-SPARC three-level architecture was proposed. Compare and contrast the three levels of this model.怎么解决数据独立性的问题

   外部层由若干不同的用户视图组成，概念层是数据库的整体视图，描述了哪些数据被存储在数据库中，以及这些数据之间的联系。内部层是数据库在计算机上的物理表示。描述数据是如何存储在数据库中的。三层体系结构通过两段映射，外部层到概念层的映射和概念层到内部层的映射，保证对低层次的修改不会影响到高层次，提供了更强的数据独立性。

2. What is a data model? Discuss three components of data model and the main types of data model.

   数据模型是一组集成的概念，用于描述和操纵组织机构内的数据、数据间联系以及对数据的约束。数据模型的三个组成部分有结构部分，由一组创建数据库的规则构成；操纵部分，定义允许对数据进行的操作的种类；一组完整性约束，确保数据的准确性。主要的数据模型有关系数据模型、网状数据模型、层次数据模型、实体-联系模型等等。

3. What is meant by the term 'client-server architecture' and what are the advantages of this approach? Compare the client-server architecture with other architecture.

   客户-服务器指的是软组件相互作用形成系统的一个方式。这种方法中存在一个请求资源的客户进程和一个提供资源的服务器。优点有广泛支持对现存数据库的访问、增强性能、降低硬件费用、降低通信费用和增强一致性。与远程处理和文件服务器结构相比，客户-服务器与文件-服务器的客户端与服务器都通过LAN进行通信，但文件-服务器的应用程序和DBMS都在客户端而客户-服务器的应用程序在客户端，数据库和DBMS在服务器。远程处理结构中终端没有处理能力，要交由中央计算机处理，中心计算机要运行应用程序和DBMS。

4. Discuss the function and importance of the system catalog.

   系统目录存放元数据，存放授权用户，存放每个数据项的约束，用户可以查询系统目录。设立系统目录，数据的信息可以被集中保存。由于数据被集中保存，冗余和一致性的问题可以被识别和控制。增强了安全性和完整性。

